ファイル根拠も含めて設計してあります

- 企業プロフィールは
    
    `/company/profile/create`（表示）
    
    `/company/profile`（登録処理）
    

が正式に定義されている 👇

✔ **ルーティング仕様**

→ `/company/profile/create` GET（表示）

→ `/company/profile` POST（登録処理）

ルーティングコントローラーサービスクラス

✔ **企業プロフィール入力項目**

→ 企業名、会社概要、担当者名/部署、自己紹介

機能要件3

✔ バリデーション項目（必須/任意）

バリデーション

---

---

# ✅ CompanyProfileController（詳細設計）

---

## ① **create（企業プロフィール登録画面表示）**

### 🌱 役割

企業がプロフィールを初回登録するための画面を返すだけ。

※DB更新は行わない

---

### 🎯 入口（リクエスト）

```
GET/company/profile/create
```

---

### 📤 出口（返却内容）

```
company/profile/create.blade.php を表示
```

この画面は機能要件の企業登録画面-2に対応

ビュー

---

### 🧠 Controller内部処理

- 認証中企業ユーザ取得 (Auth::user())
- 既にプロフィールが存在する場合
    
    → 編集画面・または企業フリーランス一覧画面へリダイレクト（再登録防止）
    
- view返却のみ

---

### 📌 サービス使用

- 不要（取得だけで更新・複雑処理なし）

---

## ② **store（企業プロフィール登録処理）**

### 🌱 役割

企業プロフィールのDB登録を行う処理の入口。

→ 実際の保存処理は service に委譲する方式が安全。

ルーティング定義あり

ルーティングコントローラーサービスクラス

---

### 🎯 入口

```
POST /company/profile
payload:
- company_name
- overview
- contact_name
- department
- introduction
```

※入力項目は機能要件の登録項目に対応

機能要件3

---

### 🧠 Controller内部処理

1. **バリデーション (CompanyRegisterRequest)**
    
    ルール定義は機能要件通り
    
    バリデーション
    
2. Auth::user() 取得
3. Serviceクラス に処理委譲

```
CompanyProfileService::register($user,$payload)
```

**Service側で行うべき処理（Controllerに持たせない理由）**

- companiesテーブルへのINSERT
    
    マイグレーション
    
- 今後項目の追加が見込まれる
- 企業情報はチャット・案件作成と密に連携

👉 拡張性・責務分離のため service 必須

1. 正常終了したら
    
    → 次の導線へ
    

---

### 📤 出口（成功時）

```
redirect'/company/freelancers'
Flash: 「企業プロフィールの登録が完了しました」
```

※機能要件の遷移仕様に対応

機能要件3

---

### ❗ 重要ポイント

Controllerには「登録処理の実装」は書かない。

理由

- Serviceに集約するべき複数テーブル参照
- 後から担当者項目・外部連携が追加される可能性が高い
- トランザクション管理が必要（ユーザー削除連鎖あり）

---

# 📌 CompanyProfileController 要点まとめ

| メソッド | 役割 | 入口 | 出口 | Service使用 |
| --- | --- | --- | --- | --- |
| create | 入力フォーム表示 | GET | view | 不要 |
| store | 企業プロフィール登録の入口 | POST | DB登録→企業向け一覧へ移動 | CompanyProfileService::register() |
