# ✅ FreelancerJobController の詳細設計（完全版）

対象となる画面/ルーティングは以下（PDFより確認済み）👇

- 案件一覧
    
    `/freelancer/jobs` GET
    
    ルーティングコントローラーサービスクラス
    
- 案件詳細
    
    `/freelancer/jobs/{id}` GET
    
    ルーティングコントローラーサービスクラス
    
- 役割は

✔ フリーランス側が

**公開中の案件を閲覧し、応募判断するための入口**

---

---

# ① index（案件一覧表示）

### 🌱 役割

「フリーランスが応募可能な案件一覧を表示するだけ」

DB更新は行わない。

---

### 🎯 入口

```
GET /freelancer/jobs
```

---

### 📤 出口

- 公開案件のみ一覧表示
    
    （status = publish のものだけ）
    
    案件のステータスと、フリーランス側への表示条件
    
- 画面：
    
    `freelancer/jobs/index.blade.php`
    
    ビュー
    
- 受け取るデータ（最低限）
    
    | データ | 説明 |
    
    |---|---|
    
    | jobs list | 件名/会社名/報酬/稼働条件など |
    
    | search keyword（任意） | テキスト全文検索要件に対応 |
    
    

---

### 🔍 検索仕様（フェーズ①）

✔ テキスト全文検索（条件1つのみ）

機能要件3

検索対象

- タイトル
- 会社名
- 報酬
- 案件概要
- 必要スキル
- 期間/稼働時間

※内部はページングでOK

---

### 🧠 Controller内部処理

1. 認証チェック
2. `status = publish` のものだけ取得
    
    → draft/stopは非表示
    
    案件のステータスと、フリーランス側への表示条件
    
3. keyword があれば全文検索（LIKE連結）
4. view に渡す

✔ この処理は Service クラス不要

（基本設計方針：単純取得は Controllerのみ）

ルーティングコントローラーサービスクラス

---

---

# ② show（案件詳細画面の表示）

### 🌱 役割

- 案件内容をフル表示する
- 「応募する」か「応募済みか」でボタン切替
    
    ビュー
    

---

### 🎯 入口

```
GET /freelancer/jobs/{id}
```

---

### 📤 出口（view返却）

- `freelancer/jobs/show.blade.php`
    
    
    ビュー
    

Viewに渡す最低限データ

| データ | 説明 |
| --- | --- |
| job record | 企業が登録した内容まるごと |
| company name | job.company 経由 |
| 必要スキル | required_skills_text |
| 報酬 | 月額or時給のレンジ（min/max） |
| 稼働条件 | work_time_text |

---

### 🧠 Controller内部処理

1. 認証済みフリーランス取得
2. job取得
3. status=publish 以外の場合
    
    → 404 or 一覧へ（見せない仕様）
    
    案件のステータスと、フリーランス側への表示条件
    
4. 該当jobに既応募か判定

```
Application::where(job_id, freelancer_id)->exists()
```

✔ 応募済なら

- 「応募済み（チャットを開く）」に表示切替
    
    （仕様に明記）
    
    機能要件3
    

✔ 未応募なら

- 「応募する」ボタンで
    
    `/freelancer/jobs/{id}/apply` へ
    
    ルーティングコントローラーサービスクラス
    

---

### 🧩 なぜ Service を呼ばない？

- 表示処理のみ
- DB更新や巻き戻しが発生しない
    
    → Controller内で完結
    
    ルーティングコントローラーサービスクラス
    

---

---

# 📌 FreelancerJobController まとめ（表形式）

| メソッド | 役割 | 入口 | 出口 | Service必要？ |
| --- | --- | --- | --- | --- |
| index | 公開案件一覧の取得＋検索 | GET /freelancer/jobs | view返却 | ❌ 不要 |
| show | 案件詳細＋応募済判定 | GET /freelancer/jobs/{id} | view返却 | ❌ 不要 |
