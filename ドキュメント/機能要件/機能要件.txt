## フェーズ①（ファーストデプロイ / MVP）前提ルール（全画面共通）

### MVPの狙い（盛りすぎない）

- 目的は **「案件を出す → 応募 or スカウト → チャットが回る」状態**を最短で作ること。 機能要件3
- 転職サイト／クラウドワークス級の完成度は初期から狙わず、フェーズ②以降で拡張する。 機能要件3

### 扱わないもの（初期はやらない）

- **時給案件は扱わない**（固定報酬・月額などのレンジを基本とする） 機能要件3
- **募集人数項目は不要（1案件=1人対応想定）**
- **募集締切／期日管理はしない**
- 実績・レビュー表示はしない（将来検討）

### 案件ステータス（企業側）とフリーランス表示条件

- 案件ステータスは **公開 / 下書き / 停止** の3種。 機能要件3 案件のステータスと、フリーランス側への表示条件
- **公開**：フリーランス一覧に表示、詳細閲覧可、応募可。 案件のステータスと、フリーランス側への表示条件
- **下書き**：フリーランスから完全非表示（一覧×、詳細×、応募×）。 案件のステータスと、フリーランス側への表示条件
- **停止**：新規検索一覧には出さない。応募済みの履歴からのみ閲覧可にする運用が成立（フェーズ①はこの軽さでOK）。応募は不可。 案件のステータスと、フリーランス側への表示条件

### 応募・スカウト・チャットの発生トリガー（最重要）

- **応募 or スカウトが起きた瞬間に、チャットスレッド（部屋）を自動生成**し、以後はその部屋でやり取りする。 応募・スカウト・チャットの「発生トリガー」の関係性
- 重要：**「応募／スカウト完了 → 即チャット画面」**が最もストレスがない導線（一覧に戻してからチャット、ではない）。 応募・スカウト・チャットの「発生トリガー」の関係性

### スレッド（チャット）の一意性（乱立防止）

- チャットは **「企業 × フリーランス × 案件（スカウトの場合は案件null可）」**の組み合わせに対して **1つだけ**存在。 スレッド（チャット）が何を軸に紐づくか スレッド（チャット）が何を軸に紐づくか
- 同じ組み合わせで複数スレッドを作らず、既存を再利用する。 機能要件3 応募・スカウト・チャットの「発生トリガー」の関係性

### 未読通知（フェーズ①は“スレッド単位”で軽く）

- 既読テーブルなし、メッセージごとに is_read も持たない。 メッセージ通知の扱い
- 未読判定は **「最後のメッセージ送信者が自分以外かどうか」**で成立。 メッセージ通知の扱い メッセージ通知の扱い
- スレッドを開いた時点で既読扱いへ更新（ページ遷移更新でOK、WebSocket不要）。 機能要件3

---

# 画面別 機能要件（条件1〜3を反映・省略なし）

---

## ① フリーランス / 企業 共通ログイン画面

### 目的

- 企業/フリーランス共通のログイン導線を1つに統合する。 機能要件3

### 表示項目

- メールアドレス入力欄
- パスワード入力欄
- 「パスワードを忘れた方はこちら」リンク
    - クリックで「パスワードリセット送信画面」へ遷移（送信導線へ）
- 「フリーランス新規登録」ボタン
- 「企業新規登録」ボタン

### 操作・遷移

- ログイン成功後の遷移：
    
    フリーランス → /freelancer/jobs
    企業           → /company/freelancers
    
- 「フリーランス新規登録」→ **② フリーランス登録画面-1**へ
- 「企業新規登録」→ **④ 企業登録画面-1**へ

---

## ② フリーランス登録画面-1（ログイン情報登録）

### 表示項目（すべて必須）

- メールアドレス
- パスワード
- パスワード確認

### バリデーション

- メール形式
- メール重複不可
- パスワード最小長・強度（方針に従う）
- パスワード確認一致

### 操作・遷移

- 「登録」押下
    - バリデーションOK → **③ フリーランス登録画面-2**へ遷移
    - NG → エラー表示（項目単位）

---

## ③ フリーランス登録画面-2（プロフィール登録：機能要件3の項目を登録）

> ここで登録する内容は「機能要件3」に記載のプロフィール項目をそのまま登録対象とする（ログイン情報以外）。 機能要件3
> 

### 表示・入力項目

- 表示名（必須） 機能要件3
- 職種（自由入力・必須） 機能要件3
- 自己紹介文（必須） 機能要件3
- スキル（自由入力 → タグ想定・必須、ユーザーが追加可能） 機能要件3 機能要件3
- 経験企業（任意、複数行入力可） 機能要件3
- ワークスタイル（必須） 機能要件3
    - 稼働可能時間（週〇時間～〇時間 / 〇時間/day / 〇日/week） 機能要件3
    - 働き方（自由入力テキスト） 機能要件3
- 希望単価（下限〜上限）（必須） 機能要件3
- ポートフォリオURL（任意・複数） 機能要件3
- ユーザーアイコン（アップロード＋プレビュー）

### バリデーション（例）

- 表示名：未入力不可
- 自己紹介：未入力不可
- 希望単価：下限<=上限、数値のみ
- URL：形式チェック（任意）

### 操作・遷移

- 「登録」押下
    - OK → **⑥ フリーランス案件一覧画面**へ遷移
    - NG → エラー表示

---

## ④ 企業登録画面-1（ログイン情報登録）

### 表示項目（必須）

- メールアドレス
- パスワード
- パスワード確認 機能要件3

### 操作・遷移

- 「登録」押下
    - OK → **⑤ 企業登録画面-2**へ
    - NG → エラー表示

---

## ⑤ 企業登録画面-2（企業プロフィール登録：機能要件3の企業登録項目）

### 表示・入力項目

- 企業名（必須） 機能要件3
- 会社概要（任意） 機能要件3
- 担当者名/部署（任意） 機能要件3
- 自己紹介（任意） 機能要件3

### 操作・遷移

- 「登録」押下
    - OK → **⑭ 企業フリーランス一覧画面**へ遷移
    - NG → エラー表示

---

## ⑥ フリーランス 案件一覧画面

### 共通ヘッダー（フリーランス側）

- 「案件一覧」
- 「応募した案件」（未読バッジ・未読数表示）
- 「スカウト」（未読バッジ・未読数表示）
- 右側にユーザーアイコン
    - アイコン押下 → 「プロフィール設定」「ログアウト」
    - 「プロフィール設定」→ **⑬**
    - 「ログアウト」→ **① 共通ログイン画面**へ

※未読は“スレッド単位”。「最後の送信者が自分以外」なら未読として数える。 
メッセージ通知の扱い 

### 一覧表示条件

- **公開案件のみ表示** 機能要件3
    
    （下書き・停止は検索一覧に出さない。停止は応募履歴側でのみ扱う運用が可能） 
    案件のステータスと、フリーランス側への表示条件
    

### 案件カード表示項目（あなた条件＋MVP合意を統合）

- 案件名（タイトル）
- 企業名
- 案件概要（短縮）
- 必須/必要スキル（自由入力の表示）
- 稼働時間（例：週〇〜〇時間）
- 契約期間（例：〇ヶ月）
- 報酬（レンジ表示：例 30〜50万）
- 「詳細」ボタン → **⑦**
- 「応募」ボタン → **⑧**（ただし応募済みなら応募済み表示で『応募済み（チャットを開く）』→ 既存スレッドへ遷移） 機能要件3

### 左サイドバー（検索）

- キーワード自由入力欄（1つ）
    - 案件情報を横断して部分一致検索（全文検索イメージ） 機能要件3
- 報酬レンジ入力欄（あなた条件）
    - 時給か単価 どちらかを クリックして選択して それぞれの どちらかの入力フォームに
    下限 上限で 数字を入力する
- 検索ボタン

---

## ⑦ フリーランス 案件詳細画面

### 表示項目（企業が登録した情報をそのまま反映、1:1対応）

- 案件タイトル 機能要件3
- 企業名（企業登録情報） 機能要件3
- 案件概要（全文） 機能要件3
- 必要スキル（企業入力をそのまま） 機能要件3
- 報酬目安（レンジテキスト） 機能要件3
- 想定稼働時間／期間（テキスト） 機能要件3

### 固定UI

- 画面下部固定 or 目立つ位置に「応募」ボタン配置 機能要件3

### 応募ボタンの分岐（必須仕様）

- 未応募：『応募する』→ **⑧ 応募メッセージ入力**へ 機能要件3
- 応募済：『応募済み（チャットを開く）』→ 既存スレッドへ遷移（同一組み合わせは1スレッド再利用） 機能要件3

---

## ⑧ フリーランス 案件応募画面

### 表示項目

- 案件名
- 企業名
- 応募メッセージ入力欄（自己紹介・アピール・意欲を記述） 機能要件3
- 「応募（送信）」ボタン

### 送信時に裏側で起きること（省略なし）

- 応募レコード作成
- チャットスレッド自動生成（企業 × フリーランス × 案件）
- 生成されたチャット画面へ遷移（※MVP導線は“即チャット”が正） 機能要件3 応募・スカウト・チャットの「発生トリガー」の関係性

※あなた条件の「応募完了メッセージを出して案件一覧に戻る」は、MVP合意（即チャット）と矛盾するため、フェーズ①では以下の扱いにする：

- **応募完了 → 即チャット画面へ遷移**（最初のメッセージが入った状態） 応募・スカウト・チャットの「発生トリガー」の関係性
- チャット画面側で「応募を送信しました」トースト表示等は可能（戻し先はユーザーがヘッダーで選べる）

---

## ⑨ フリーランス 応募した案件一覧（タブ：応募中 / 終了）

### 表示構造

- タブ：応募中 / 終了（切替可能） 機能要件3
- 各案件カードに以下を表示（案件一覧と同等＋未読）
    - 案件名 / 企業名 / 案件概要 / スキル / 稼働時間 / 契約期間 / 報酬レンジ
    - 未読があれば「未読」表示＋件数（スレッド単位）
    - 「チャット画面へ」ボタン
    - カード全体クリックでも遷移可（あなた条件）

### 終了への移動条件

- 企業側が応募案件チャットで「終了（クローズ）」扱いにした場合、応募中→終了へ移動
    
    （ステータス管理は重くしすぎず、応募は 未対応/対応中/クローズ の3段階が最小） 
    ステータス管理の重さを決めておく
    

### 遷移

- カードクリック or 「チャット画面へ」 → **⑩ 応募案件チャット**へ

---

## ⑩ フリーランス 応募した案件チャット画面（応募中 / 終了）

### 表示内容

- 画面上部：案件名・企業名など（識別できる最低限）
- チャット本文（時系列）
    - 左：自分
    - 右：企業
- 「最初のメッセージ」＝応募時に送ったメッセージを先頭に表示（あなた条件、かつトリガー資料と整合） 機能要件3

### 機能

- テキスト送信 機能要件3
- 自分のメッセージ削除（自分のメッセージのみ） 機能要件3
- 未読解除
    - チャット画面を開いた時点で既読へ更新（スレッド単位、WebSocket不要） 機能要件3 メッセージ通知の扱い

### 終了（クローズ）の扱い

- 終了タブでも閲覧は可能
- 終了状態では送信入力、削除を無効

---

## ⑪ フリーランス スカウト一覧画面

### 表示項目（カード）

- 企業名
- 担当者
- スカウトメッセージ（先頭または全文）
- 未読表示（スレッド単位）
- 「チャットへ」ボタン

### 遷移

- カード全体クリック or 「チャットへ」 → **⑫ スカウトチャット**へ

※スカウトは案件に紐付いていなくてOK（フェーズ①合意）。 
機能要件3 
応募・スカウト・チャットの「発生トリガー」の関係性

---

## ⑫ フリーランス スカウトチャット画面

### 表示内容（応募チャットと同等構成）

- 先頭に「スカウト送信時のメッセージ」を表示（最初のメッセージ） 応募・スカウト・チャットの「発生トリガー」の関係性
- 左右交互表示（自分/企業）
- 入力欄＋送信
- 自分のメッセージ削除
- 開いた時点で未読解除（スレッド単位）

---

## ⑬ フリーランス プロフィール設定画面

### 表示・編集対象（メール/パスワード以外）

- 表示名
- 職種（自由入力）
- 自己紹介
- スキル（タグ方式、追加可能）
- 経験企業
- ワークスタイル（稼働時間・働き方）
- 希望単価（下限〜上限）
- ポートフォリオURL 機能要件3

### 操作

- 「更新」ボタンで保存
- バリデーションは登録時と同等

※プロフィールは “検索・表示用データ” として使われる前提（企業検索の判断材料）。 
プロフィールは「検索・表示用のデータ」になること 

### 共通ヘッダー（企業側）

- 「フリーランス一覧」
- 「応募された案件」（未読バッジ・未読数表示）
- 「スカウト」（未読バッジ・未読数表示）
- 右側にユーザーアイコン
    - アイコン押下 → 「プロフィール設定」「ログアウト」
    - 「プロフィール設定」→
    - 「ログアウト」→ **① 共通ログイン画面**へ

---

## ⑭ 企業 フリーランス一覧画面（3カラム：左検索 / 中央一覧 / 右詳細）

### 画面レイアウト

- 左サイドバー：検索入力欄
- 中央：フリーランス一覧（カード）
- 右サイドバー：選択したフリーランス詳細

### 左サイドバー（検索仕様：フェーズ①）

- フリーワード（自由入力）
    - プロフィール全体を横断検索（全文検索イメージ）
- 希望単価（下限〜上限）も文字列として部分一致検索（フェーズ①の軽さ） 機能要件3

### 中央（フリーランスカード表示項目：あなた条件）

- アイコン
- 表示名
- 職種
- スキル
- 経験企業
- ワークスタイル（稼働可能時間・働き方）
- 希望単価
- ポートフォリオ
- 「スカウト」ボタン → **⑮**へ

### 右サイドバー（フリーランスクリックすると詳細表示）

- アイコン
- 表示名
- 自己紹介（全文）

---

## ⑮ 企業 フリーランス スカウト入力画面

### 表示項目

- 宛先フリーランス名（表示名）
- スカウトメッセージ入力欄
- 「送信」ボタン

### 送信時に裏側で起きること（省略なし）

- スカウトレコード作成
- チャットスレッド自動生成（企業 × フリーランス ）
- 最初のメッセージを記録（スカウト文が1通目として入る）
- 送信完了 → **⑭ フリーランス一覧**へ戻す（あなた条件）
- フリーランス側ヘッダー「スカウト」に未読バッジ+1（未読判定はスレッド単位） メッセージ通知の扱い

---

## ⑯ 企業 応募された案件一覧（タブ：応募中 / 終了）

### 表示項目（カード）

- 案件情報（案件一覧と同等：タイトル/企業名/報酬/稼働/期間/概要/必要スキル/想定業務/ステータス相当） 機能要件3
- 応募したフリーランスのアイコン＋表示名
- 未読表示（スレッド単位）
- 「チャットへ」ボタン
- カード全体クリックで遷移可

### 遷移

- → **⑰ 企業 応募案件チャット画面**

---

## ⑰ 企業 応募された案件チャット画面

### 表示・機能

- 応募時の最初のメッセージを先頭に表示（応募トリガー仕様） 機能要件3
- テキスト送信
- 自分のメッセージ削除
- 未読解除（開いた時点で既読）
- 応募ステータス更新（軽量）：未対応 → 対応中 → クローズ（終了） ステータス管理の重さを決めておく

---

## ⑱ 企業 スカウト一覧画面

### 表示項目

- フリーランスのアイコン
- 表示名
- 未読表示（スレッド単位）
- 「チャット画面へ」ボタン

### 遷移

- カードクリック or ボタン → **⑲ 企業 スカウトチャット画面**へ

---

## ⑲ 企業 スカウトチャット画面

### 表示・機能

- 先頭に「スカウト送信時の最初のメッセージ」を表示 応募・スカウト・チャットの「発生トリガー」の関係性
- テキスト送信
- 自分のメッセージ削除
- 未読解除（開いた時点で既読）

---

## ⑳ 企業 プロフィール設定画面

### 表示・編集対象（メール/パスワード以外）

- 企業名
- 会社概要
- 担当者名/部署
- 自己紹介

### 操作

- 「更新」ボタンで保存

---

## ㉑ 企業 自社案件一覧画面

### 一覧表示項目（機能要件3準拠）

- タイトル / 会社名 / 報酬 / 稼働 / 期間 / 案件概要 / 必要スキル / 想定業務 / ステータス

### 操作

- 「編集」ボタン → **㉒**
- 「削除」ボタン → 削除（確認ダイアログ推奨）
- 「新規登録」ボタン → **㉓**

### 左サイドバー（検索）

- 自由入力キーワード検索（自社案件内を部分一致）

### ステータス操作

- 公開/非公開の切替

---

## ㉒ 企業 自社案件編集画面

### 入力項目（案件登録と同一。省略なし）

- タイトル（必須）
- 会社名
- 案件概要（必須）
- 想定業務
- 必要スキル（自由入力）
- 報酬目安（例：30万円〜50万円）
- 期間（例：2〜3ヶ月）
- 稼働時間（例：週10〜20時間）
- ステータス（公開/非公開）

### 操作

- 「更新」→ バリデーションOKなら保存 → **㉑ 自社案件一覧**へ戻る

---

## ㉓ 企業 自社案件登録画面

### 入力項目（編集画面と同一。省略なし）

- タイトル（必須）
- 会社名
- 案件概要（必須）
- 想定業務
- 必要スキル（自由入力）
- 報酬目安（例：30万円〜50万円または2000円～3000円）
- 期間（例：2〜3ヶ月）
- 稼働時間（例：週10〜20時間）
- ステータス（公開/非公開） 機能要件3

### 操作

- 「登録」→ 保存成功 → **㉑ 自社案件一覧**に追加される
- 公開にした案件のみ **⑥ フリーランス案件一覧**に表示される 案件のステータスと、フリーランス側への表示条件

---

# 未読バッジ仕様（あなたの※要件の“書き漏れ防止”まとめ）

全ページで共通適用（対象：応募スレッド／スカウトスレッド）

- 未読判定：**最後の送信者が自分以外** → 未読 メッセージ通知の扱い
- 一覧画面（⑨⑪⑯⑱）：
    - スレッドが未読ならカードに「未読」表示＋件数（スレッド単位）
- ヘッダー（フリーランス：応募した案件/スカウト、企業：応募された案件/スカウト）：
    - 未読スレッド数を集計してバッジ表示（スレッド単位なので集計が軽い） メッセージ通知の扱い
- チャット画面（⑩⑫⑰⑲）：
    - 開いた時点で既読へ更新（WebSocket不要） 機能要件3