# â‘  usersï¼ˆå…±é€šãƒ­ã‚°ã‚¤ãƒ³ï¼‰

```php
<?php

useIlluminate\Database\Migrations\Migration;
useIlluminate\Database\Schema\Blueprint;
useIlluminate\Support\Facades\Schema;

/**
 * users
 * å…±é€šãƒ­ã‚°ã‚¤ãƒ³ï¼ˆä¼æ¥­ / ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ï¼‰
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('users', function (Blueprint$table) {
$table->id();

// ãƒ­ã‚°ã‚¤ãƒ³ç”¨ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
$table->string('email')->unique();

// ãƒãƒƒã‚·ãƒ¥åŒ–ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
$table->string('password');

// ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¨®åˆ¥
$table->enum('role', ['company', 'freelancer']);

            $table->timestamp('email_verified_at')->nullable();
            $table->rememberToken();
            $table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('users');
    }
};

```

---

# â‘¡ companiesï¼ˆä¼æ¥­ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ï¼‰

```php
<?php

/**
 * companies
 * ä¼æ¥­ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('companies', function (Blueprint$table) {
$table->id();

$table->foreignId('user_id')
                ->constrained('users')
                ->cascadeOnDelete();

// ä¼æ¥­å
$table->string('name');

// ä¼šç¤¾æ¦‚è¦
$table->text('overview')->nullable();

// æ‹…å½“è€…æƒ…å ±
$table->string('contact_name')->nullable();
$table->string('department')->nullable();

// è‡ªå·±ç´¹ä»‹
$table->text('introduction')->nullable();

$table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('companies');
    }
};

```

---

# â‘¢ freelancersï¼ˆãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ï¼šâ€»é‡è¦ä¿®æ­£ã‚ã‚Šï¼‰

```php
<?php

/**
 * freelancers
 *
 * ã€é‡è¦ä¿®æ­£ã€‘
 * ç¨¼åƒæ¡ä»¶ã‚’ä»¥ä¸‹4ã‚«ãƒ©ãƒ ã§ç®¡ç†
 * - min_hours_per_week
 * - max_hours_per_week
 * - hours_per_day
 * - days_per_week
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('freelancers', function (Blueprint$table) {
$table->id();

$table->foreignId('user_id')
                ->constrained('users')
                ->cascadeOnDelete();

// è¡¨ç¤ºå
$table->string('display_name');

// è·ç¨®
$table->string('job_title');

// è‡ªå·±ç´¹ä»‹
$table->text('bio');

// ==========================
// ç¨¼åƒæ¡ä»¶ï¼ˆæ­£è¦åŒ–ï¼‰
// ==========================
// é€±ã®ç¨¼åƒæ™‚é–“ï¼ˆä¸‹é™ï¼‰
$table->unsignedTinyInteger('min_hours_per_week');

// é€±ã®ç¨¼åƒæ™‚é–“ï¼ˆä¸Šé™ï¼‰
$table->unsignedTinyInteger('max_hours_per_week');

// 1æ—¥ã®ç¨¼åƒæ™‚é–“
$table->unsignedTinyInteger('hours_per_day');

// é€±ã®ç¨¼åƒæ—¥æ•°
$table->unsignedTinyInteger('days_per_week');

// ==========================
// åƒãæ–¹ï¼ˆè‡ªç”±å…¥åŠ›ï¼‰
// ==========================
$table->text('work_style_text');

// å¸Œæœ›å˜ä¾¡ï¼ˆä¸‹é™ / ä¸Šé™ï¼‰
$table->unsignedInteger('min_rate');
$table->unsignedInteger('max_rate');

// çµŒé¨“ä¼æ¥­
$table->text('experience_companies')->nullable();

// ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒãƒ‘ã‚¹
$table->string('icon_path');

$table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('freelancers');
    }
};

```

---

# â‘£ freelancer_portfoliosï¼ˆãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªï¼‰

```php
<?php

/**
 * freelancer_portfolios
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('freelancer_portfolios', function (Blueprint$table) {
$table->id();

$table->foreignId('freelancer_id')
                ->constrained('freelancers')
                ->cascadeOnDelete();

$table->string('url');
$table->unsignedSmallInteger('sort_order')->default(0);

$table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('freelancer_portfolios');
    }
};

```

---

# â‘¤ skills / freelancer_skillï¼ˆå…±é€šã‚¹ã‚­ãƒ«ï¼‰

```php
<?php

/**
 * skills
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('skills', function (Blueprint$table) {
$table->id();
$table->string('name')->unique();
$table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('skills');
    }
};

```

```php
<?php

/**
 * freelancer_skill
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('freelancer_skill', function (Blueprint$table) {
$table->id();

$table->foreignId('freelancer_id')
                ->constrained('freelancers')
                ->cascadeOnDelete();

$table->foreignId('skill_id')
                ->constrained('skills')
                ->cascadeOnDelete();

$table->unique(['freelancer_id','skill_id']);
$table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('freelancer_skill');
    }
};

```

---

# â‘¥ freelancer_custom_skillsï¼ˆâ€»æ¤œç´¢å¯¾å¿œï¼‰

```php
<?php

/**
 * freelancer_custom_skills
 *
 * ã€ä¿®æ­£æ–¹é‡ã€‘
 * - æ§‹é€ ã¯ãã®ã¾ã¾
 * - æ¤œç´¢ã«ã‚‚ä½¿ãˆã‚‹ã‚ˆã† index ã‚’è¿½åŠ 
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('freelancer_custom_skills', function (Blueprint$table) {
$table->id();

$table->foreignId('freelancer_id')
                ->constrained('freelancers')
                ->cascadeOnDelete();

// è‡ªç”±å…¥åŠ›ã‚¹ã‚­ãƒ«åï¼ˆæ¤œç´¢å¯¾è±¡ï¼‰
$table->string('name');

$table->unsignedSmallInteger('sort_order')->default(0);

// ğŸ” æ¤œç´¢ç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
$table->index('name');

$table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('freelancer_custom_skills');
    }
};

```

---

# â‘¦ jobsï¼ˆæ¡ˆä»¶ï¼šâ€»å ±é…¬è¨­è¨ˆã‚’å¤§å¹…ä¿®æ­£ï¼‰

```php
<?php

/**
 * jobs
 *
 * ã€é‡è¦ä¿®æ­£ã€‘
 * - æœˆé¡/æ¡ˆä»¶å˜ä¾¡ or æ™‚çµ¦ ã®ä¸¡å¯¾å¿œ
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('jobs', function (Blueprint$table) {
$table->id();

$table->foreignId('company_id')
                ->constrained('companies')
                ->cascadeOnDelete();

// æ¡ˆä»¶å
$table->string('title');

// æ¡ˆä»¶æ¦‚è¦
$table->text('description');

// å¿…è¦ã‚¹ã‚­ãƒ«ï¼ˆãƒ†ã‚­ã‚¹ãƒˆï¼‰
$table->text('required_skills_text')->nullable();

// ==========================
// å ±é…¬è¨­å®š
// ==========================
// reward_type:
// - monthly : æœˆé¡ / æ¡ˆä»¶å˜ä¾¡
// - hourly  : æ™‚çµ¦
$table->enum('reward_type', ['monthly', 'hourly']);

            // é‡‘é¡ãƒ¬ãƒ³ã‚¸ï¼ˆå…±é€šï¼‰
            $table->unsignedInteger('min_rate');
            $table->unsignedInteger('max_rate');

            // ç¨¼åƒæ¡ä»¶ï¼ˆè¡¨ç¤ºç”¨ï¼‰
            $table->string('work_time_text');

            // 0=draft / 1=publish / 2=stop
            $table->unsignedTinyInteger('status')->default(0);

            $table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('jobs');
    }
};

```

---

# â‘§ applicationsï¼ˆå¿œå‹Ÿï¼‰

```php
<?php

/**
 * applications
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('applications', function (Blueprint$table) {
$table->id();

$table->foreignId('job_id')
                ->constrained('jobs')
                ->cascadeOnDelete();

$table->foreignId('freelancer_id')
                ->constrained('freelancers')
                ->cascadeOnDelete();

$table->text('message');

// 0=æœªå¯¾å¿œ / 1=å¯¾å¿œä¸­ / 2=ã‚¯ãƒ­ãƒ¼ã‚º
$table->unsignedTinyInteger('status')->default(0);

$table->unique(['job_id','freelancer_id']);
$table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('applications');
    }
};

```

---

# â‘¨ scoutsï¼ˆã‚¹ã‚«ã‚¦ãƒˆï¼‰

```php
<?php

/**
 * scouts
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('scouts', function (Blueprint$table) {
$table->id();

$table->foreignId('company_id')
                ->constrained('companies')
                ->cascadeOnDelete();

$table->foreignId('freelancer_id')
                ->constrained('freelancers')
                ->cascadeOnDelete();

$table->foreignId('job_id')
                ->nullable()
                ->constrained('jobs')
                ->nullOnDelete();

$table->text('message');

// 0=æœªå¯¾å¿œ / 1=å¯¾å¿œä¸­ / 2=ã‚¯ãƒ­ãƒ¼ã‚º
$table->unsignedTinyInteger('status')->default(0);

$table->index(['company_id','freelancer_id','job_id']);
$table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('scouts');
    }
};

```

---

# â‘© threadsï¼ˆãƒãƒ£ãƒƒãƒˆã‚¹ãƒ¬ãƒƒãƒ‰ï¼‰

```php
<?php

/**
 * threads
 * æœªèª­ç®¡ç†ã¯ã‚¹ãƒ¬ãƒƒãƒ‰å˜ä½
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('threads', function (Blueprint$table) {
$table->id();

$table->foreignId('company_id')
                ->constrained('companies')
                ->cascadeOnDelete();

$table->foreignId('freelancer_id')
                ->constrained('freelancers')
                ->cascadeOnDelete();

$table->foreignId('job_id')
                ->nullable()
                ->constrained('jobs')
                ->nullOnDelete();

$table->enum('latest_sender_type', ['company', 'freelancer'])->nullable();
            $table->unsignedBigInteger('latest_sender_id')->nullable();

            $table->timestamp('latest_message_at')->nullable();

            $table->boolean('is_unread_for_company')->default(false);
            $table->boolean('is_unread_for_freelancer')->default(false);

            $table->index(['company_id', 'freelancer_id', 'job_id']);
            $table->timestamps();
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('threads');
    }
};

```

---

# â‘ª messagesï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰

```php
<?php

/**
 * messages
 */
returnnewclassextendsMigration {
publicfunctionup():void
    {
Schema::create('messages', function (Blueprint$table) {
$table->id();

$table->foreignId('thread_id')
                ->constrained('threads')
                ->cascadeOnDelete();

$table->enum('sender_type', ['company', 'freelancer']);
            $table->unsignedBigInteger('sender_id');

            $table->text('body');
            $table->timestamp('sent_at');

            // è‡ªåˆ†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰Šé™¤å¯¾å¿œ
            $table->softDeletes();

            $table->timestamps();
            $table->index(['thread_id', 'sent_at']);
        });
    }

publicfunctiondown():void
    {
Schema::dropIfExists('messages');
    }
};

```

---

## âœ… æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—å€™è£œï¼ˆãŠã™ã™ã‚é †ï¼‰

1. **ã“ã®DBæ§‹é€ ã‚’ERå›³ã«è½ã¨ã™**
2. **jobs.reward_type ã‚’ä½¿ã£ãŸè¡¨ç¤ºåˆ†å²ä»•æ§˜ã®æ•´ç†**
3. **æ¤œç´¢ã‚¯ã‚¨ãƒªè¨­è¨ˆï¼ˆfreelancers / jobs ä¸¡æ–¹ï¼‰**
4. **Seederï¼ˆãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰è¨­è¨ˆ**
